<nb-card>
  <nb-card-body>
    <div class="row">
      <h3>Users</h3>
      <button (click)="openWindow()" nbButton status="primary">Add User</button>
      <button (click)="refreshData()" style="margin-left: 5px;" nbButton status="primary">Refresh Data</button>

    </div>

    <table *ngIf="allCols.length>0" [nbTreeGrid]="data">

      <tr nbTreeGridHeaderRow *nbTreeGridHeaderRowDef="allCols"></tr>
      <tr [clickToToggle]="false" nbTreeGridRow *nbTreeGridRowDef="let row; columns: allCols"></tr>


      <ng-container *ngFor="let col of allColumns" [nbTreeGridColumnDef]="col.key">
        <th nbTreeGridHeaderCell *nbTreeGridHeaderCellDef>{{col.name}}</th>
        <td nbTreeGridCell *nbTreeGridCellDef="let row;let i=index">
          <ng-container *ngIf="row.data['actions']==buttonGroups.VIEW">
            <ng-container [ngSwitch]="col.key">
              <span *ngSwitchCase="'actions'">
                <nb-card-body>
                  <button (click)="editRow(i)" size="tiny" nbButton status="primary" class="actions">Edit</button>
                  <button (click)="deleteRow(i)" nbButton size="tiny" status="primary">Delete</button>
                </nb-card-body>
              </span>
              <span *ngSwitchCase="'date'">{{row.data[col.key] | date}}</span>
              <span *ngSwitchCase="'role'">{{getRole(row.data[col.key])}}</span>
              <span *ngSwitchDefault>{{row.data[col.key] || '-'}}</span>
            </ng-container>

          </ng-container>
          <ng-container *ngIf="row.data['actions']==buttonGroups.EDIT">
            <input formControlName="{{col.key}}" *ngIf="col.key!=='actions'" [value]="row.data[col.key]">
            <nb-card-body *ngIf="col.key=='actions'">
              <button (click)="saveChanges(i)" size="tiny" nbButton status="primary" class="actions">Save</button>
              <button (click)="cancel(i)" nbButton size="tiny" status="primary">Cancel</button>
            </nb-card-body>
          </ng-container>
        </td>
      </ng-container>

    </table>

  </nb-card-body>
</nb-card>

<ng-template #contentTemplate let-data>
  <form [formGroup]="userForm" (ngSubmit)="data.index>-1?saveChanges(data.index):addUser()">
    <nb-card>
      <nb-card-body class="example-items-col">
        <input nbInput class="form-control" formControlName="firstName" placeholder="First Name" type="text">
        <input nbInput class="form-control" formControlName="middleName" placeholder="Middle Name" type="text">
        <input nbInput class="form-control" formControlName="lastName" placeholder="Last Name" type="text">
        <input nbInput class="form-control" formControlName="email" placeholder="Email" type="text">
        <input nbInput class="form-control" formControlName="phoneNumber" placeholder="Phone Number" type="text">
        <nb-select formControlName="role" placeholder="Role">
          <nb-option value=1>Super Admin</nb-option>
          <nb-option value=2>Admin</nb-option>
          <nb-option value=3>Subscrber</nb-option>
        </nb-select>
        <input nbInput class="form-control" formControlName="date" placeholder="Date" type="date">

        <button type="submit" nbButton status="primary">Submit</button>
      </nb-card-body>
    </nb-card>
  </form>
</ng-template>